<!DOCTYPE html>
<html >
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="YuxiangQ" />


    
    


<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Code4Cocoa">
<meta property="og:url" content="http://code4cocoa.com/page/3/index.html">
<meta property="og:site_name" content="Code4Cocoa">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Code4Cocoa">
<meta name="twitter:description">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Code4Cocoa" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css" type="text/css">


    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Code4Cocoa</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">YuxiangQ</a></h1>
        </hgroup>

        
        <p class="header-subtitle">A Programer&#39;s Home</p>
        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜單</li>
                        <li>標籤</li>
                        
                        <li>友情鏈接</li>
                        
                        
                        <li>關於我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="/#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/App比较/">App比较</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DDoS/">DDoS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eventkit/">Eventkit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GFW/">GFW</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GPS/">GPS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-APP/">Mac APP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Objective-C/">Objective-C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swfit/">Swfit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swift/">Swift</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UICollectionViewController/">UICollectionViewController</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UIImage/">UIImage</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UITableVIewCell/">UITableVIewCell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UITableView/">UITableView</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UITableViewCell/">UITableViewCell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VFL/">VFL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VPN/">VPN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebAPP/">WebAPP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/">iOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/下拉刷新/">下拉刷新</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/个人总结/">个人总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/串行请求/">串行请求</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/学习/">学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/定位/">定位</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小工具/">小工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/异步/">异步</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/手势/">手势</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/指针/">指针</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/指针变量/">指针变量</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/程序/">程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/稍后读/">稍后读</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程/">编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/翻墙/">翻墙</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自动布局/">自动布局</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自定义控件/">自定义控件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/行业发展/">行业发展</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/请求队列/">请求队列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/随笔/">随笔</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">YuxiangQ</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">YuxiangQ</a></h1>
            </hgroup>
            
            <p class="header-subtitle">A Programer&#39;s Home</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="/#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="標籤" friends="友情鏈接" about="關於我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-Swift学习笔记一" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/10/12/Swift学习笔记一/" class="article-date">
      <time datetime="2014-10-11T16:29:48.000Z" itemprop="datePublished">2014-10-12</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/12/Swift学习笔记一/">Swift学习笔记一</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>随着6月初WWDC 2014的落幕，iOS程序员圈子里掀起了学习Swift的热潮，预计再过2年，Swift将成为开发Mac OS X/iOS 程序的主力语言。</p>
<p>最近在群里和论坛上，都看到初学者在问，到底是学Objective-C好还是Swift好。其实我认为，与其这样纠结的各个群、各个论坛的询问，不如二者一起学习(Objective-C为主，Swift为辅)。毕竟现阶段一般都会支持iOS 7/8，在国内环境也很难做到只支持iOS 8，甚至会要求支持到iOS 5/6。所以作为iOS程序员，Objective-C是不能缺的技能，优先学习Objective-C是没有问题的。而Swift替代Objective-C我相信还有很长的时间，尤其是在国内环境，时间应该会更长一点。毕竟国内要求支持的iOS版本跨度更大。</p>
<p>根据WWDC 2014上的介绍 <em>Swift 是一种新的编程语言，用于编写 iOS 和 OS X 应用。Swift 结合了 C 和 Objective-C 的优点并且不受 C 兼容性的限制。Swift 采用安全的编程模式并添加了很多新特性，这将使编程更简单，更灵活，也更有趣。Swift 是基于成熟而且倍受喜爱的 Cocoa 和 Cocoa Touch 框架，它的降临将重新定义软件开发。</em> 通过以上的介绍，我们可以很清晰的了解到，对于熟悉Cocoa 和 Cocoa Touch的程序员来说，从Objective-C迁移到Swift是一件很轻松的事情，毕竟学一门语言，就是在学库，既然两者库是通用的，那么只需要了解基本语法，就能完成部分工作了。剩下的就是学习语言的高级特性，重构代码。</p>
<p>从目前的介绍来看，Swift颇有脚本语言的风格。<em>它是第一个既满足工业标准又像脚本语言一样充满表现力和趣味的编程语言。它支持代码预览，这个革命性的特性可以允许程序员在不编译和运行应用程序的前提下运行 Swift 代码并实时查看结果。</em>我真是迫不及待的想开始学习它了。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swift/">Swift</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-自学VB时的回忆" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/09/27/自学VB时的回忆/" class="article-date">
      <time datetime="2014-09-27T10:12:03.000Z" itemprop="datePublished">2014-09-27</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/09/27/自学VB时的回忆/">自学VB时的回忆</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>前几天在知乎上看到一个问题——<a href="http://www.zhihu.com/question/25526940/answer/31006493" target="_blank" rel="external">如果每天坚持用12个小时学习一门编程语言，一年下来，编程能力会达到什么程度？</a>。其中<a href="http://www.zhihu.com/people/vczh-the-wise" target="_blank" rel="external">轮子哥</a>的回答，不禁让自己想起了初中时代学习VB的事情。</p>
<p>说来惭愧，轮子哥初中时代学习VB，现在已是一方大牛，自己初中时代也买了本VB学习，现在还是一方码农，这就是命啊。<br>家里初一的时候，买了第一台电脑，记得配置是赛扬445，内存128M，自己是爱不释手，各种折腾。慢慢自己折腾会了装系统，使用虚拟光驱，知道了什么是镜像，什么是快捷方式=。=，当然很大一部分时间实在网络上各种闲逛，还有玩经典的单机游戏和模拟器。当时很喜欢买的杂志是《模拟时代》和《模拟XX》(名字忘了。。。反正也是挺出名的)，因为自己是一个很热爱游戏的人，小学的时候就混迹于街机厅和PS游戏室，在电脑上发现了模拟器这个东西的时候真是如获至宝，天天玩得不亦乐乎。当时主要玩GBA模拟器，《火焰纹章 烈火之剑》《恶魔城》三作，我都是在上面通关的，当然还有CPS1&amp;2主板上的经典游戏。后来慢慢的很崇拜模拟器的作者，就很想自己学习编写模拟器，不过当时自己不知道怎么入门，于是在网上找资料，其实自己当时连HTML、C、VB这些的区别都不知道，就看论坛上得人们怎么说，学什么更好入门。后来自己就直接跑到新华书店，去计算机图书区看看有些什么书。先看了一本C语言，看着里面的Helloworld，着实提不起兴趣，和自己想想中的写出模拟器的语言相差很大。正好旁边放着一本Visual Basic 6.0程序设计，于是拿起来翻了翻，真是让我眼前一亮。第一篇的Helloword就是熟悉的窗体，这才是做模拟器的语言哎╮(╯▽╰)╭。于是果断将此书买回家，下了个VB开始弄，第一篇helloword我是将整个实例程序都敲了一遍，包括注释(当时我还不理解什么叫「注释」，以为是程序不可分割的一部分)。但是程序始终跑不起来，原因嘛，我相信初学编程的朋友都遇到过，就是符号全角和半角的问题。当时自己实在是二，还拿着书跑去学校问计算机课老师，结果老师表示也不懂，无奈放弃了。倘若在你初学的时候，身边有个有经验的人能点拨你一下，能取得事倍功半的效果。</p>
<p>后来，这本书就这样静静得躺在了书柜里，偶尔被翻出来，学习一下，但是一直没能跨过入门那道坎。现在想来，自己那个时候自学的能力真是差劲，倘若能很好的利用网络资源的话，估计我的程序人生会提前一大步，哈哈。<br>考上大学的时候，义无反顾的选择了软件开发专业，虽然挺多人觉得这个专业的人滥大街了，所以很多同学选择了土木、生物等相关朝阳专业，不过对我而言，能做自己喜欢的事情才是最重要的。<br>大学报到的时候将那本书带去了学校，毕业以后又随我留在了工作的城市。不知可否成为一件传家宝，就这么传承下去。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编程/">编程</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-关于指针及指针变量" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/09/05/关于指针及指针变量/" class="article-date">
      <time datetime="2014-09-05T14:39:16.000Z" itemprop="datePublished">2014-09-05</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/09/05/关于指针及指针变量/">关于指针及指针变量</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>我在刚学习C语言的时候，一直不能很好的理解<strong>指针</strong>和<strong>指针变量</strong>(再加上神马函数指针，指针函数，指针的指针，有木有觉得绕晕了？o(╯□╰)o)。后来慢慢的有点感觉了，想到一种巧妙的理解方式。</p>
<p>大家都用过Windos系统(废话o(╯□╰)o)，Windows桌面上都会有快捷方式(想起小时候还做过蠢事。那个时候初一，家里买了电脑，自己去网吧拷游戏玩。将桌面上所有游戏拷到一个U盘里面，当然全是快捷方式，当时还在纳闷为啥游戏拷得那么快。。。。太糗了)，快捷方式并不是真正的程序，而是指向程序的一个变量(图标)。快捷方式就像指针变量，他保存的是指针(程序在硬盘上的真实地址)，通过它我们能找到硬盘上真正的程序并且运行。</p>
<p>现在有木有一种豁然开朗的感觉?另外刚学C语言的时候，我们老师说可以将书中出现的<strong>指针</strong>替换为<strong>地址</strong>，这样就能更好的理解，比如<strong>函数指针</strong>等于<strong>函数地址</strong>，<strong>指针函数</strong>等于<strong>地址函数</strong>(感觉比较怪，即该函数的返回值为地址)。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/指针/">指针</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/指针变量/">指针变量</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/程序/">程序</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-UIImageView展示大图学习笔记" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/08/30/UIImageView展示大图学习笔记/" class="article-date">
      <time datetime="2014-08-30T14:23:07.000Z" itemprop="datePublished">2014-08-30</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/30/UIImageView展示大图学习笔记/">UIImageView展示大图学习笔记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>UIImageView展示超大分辨率图片，我们主要通过Apple官方实例<a href="https://developer.apple.com/library/ios/samplecode/LargeImageDownsizing/Introduction/Intro.html" target="_blank" rel="external"><strong>Large Image Downsizing</strong></a>来进行学习。</p>
<p>官方实例中，用于展示的图片<em>large_leaves_70mp.jpg</em>，分辨率达到了惊人的7033 × 10110。要展示这么一张图片，我相信大家都能立即意识到，通过通常方法(imageView.image=image)是无法正常显示的。Apple的文档和实例给我了我们一个很好的思路。</p>
<p>针对这个问题，我们的Android工程师的解决方案是将图片按照屏幕分辨率进行等比裁剪。及针对7033 <em> 10110分辨率的图片为了在1280 </em> 720分辨率的手机上展示成功，至少会把原图裁剪为703 * 1011。这样可以大幅减少显示图片的内存消耗，基本解决了APP显示大图的问题。但是这样总会有不足，假设有款手机分辨率是1080P，但只有512MB ROM(这个例子比较极端)，那么上面那种按照屏幕分辨率的裁剪方式就会有问题，图片依然没法正确显示。Apple Sample中的做法是利用QuartzCore来进行绘制，并且将图片分割成多个Tile进行绘制。</p>
<p>官方实例中，首先获取了原始图片的高度和宽度</p>
<pre><code>
/* 获取原始照片的宽度和高度 */
sourceResolution.width = CGImageGetWidth(sourceImage.CGImage);
sourceResolution.height = CGImageGetHeight(sourceImage.CGImage);
</code></pre>
[CGImageGetWidth和UIImage.size.width方法返回的结果都是一样的，照片宽有多少像素。前者效率更高。评论中有人提到并不一样，大家可以参考。主要分歧是UIImage.size.width是否受scale的影响](http://stackoverflow.com/questions/12954319/is-difference-between-cgimagegetwidthworkingimage-cgimage-and-workingimage-siz)

计算图片的总像素
<pre><code>
sourceTotalPixels = sourceResolution.width * sourceResolution.height;
</code></pre>

<p>计算未压缩的图片占用多大内存</p>
<pre><code>
sourceTotalMB = sourceTotalPixels / pixelsPerMB;
</code></pre>

<p>计算缩放比例</p>
<pre><code>
imageScale = destTotalPixels / sourceTotalPixels;
</code></pre>

<p>计算缩放后的宽度和高度，公式为 <strong>缩放后高度=原高度 * 缩放比例</strong></p>
<pre><code>
destResolution.width = (int)(sourceResolution.width * imageScale);
destResolution.height = (int)(sourceResolution.height * imageScale);
</code></pre>

<p>接下来我们进行绘图工作,首先获取当前设备的色彩空间(色彩范围)。</p>
<pre><code>
CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
//计算缩放后的图片每一行的字节数。
int bytesPerRow = bytesPerPixel * destResolution.width;
</code></pre>

<p>为需要显示的图片分配足够的像素空间。</p>
<pre><code>
void *destBitmapData = malloc(bytesPerRow * destResolution.height);
</code></pre>

<p><a href="http://blog.csdn.net/wangyuchun_799/article/details/7804809" target="_blank" rel="external">CGBitmapContextCreate函数参数详解</a></p>
<pre><code>
//创建输出图像的上下文
destContext = CGBitmapContextCreate(
destBitmapData/*输出图片需要的像素地址*/
, destResolution.width/*输出图片的宽度*/
, destResolution.height/*输出图片的高度*/
, 8/*内存中像素的每个组件的位数.例如，对于32位像素格式和RGB 颜色空间，你应该将这个值设为8*/
, bytesPerRow/*输出图片每行字节数*/
, colorSpace/*当前设备色彩范围*/
, kCGImageAlphaPremultipliedLast
);
</code></pre>

<p>对需要展示的位图进行移动和缩放，是我们能够在屏幕上看清图片全貌。</p>
<pre><code>
//移动图片
CGContextTranslateCTM(destContext, 0.0f, destResolution.height);
//缩放图片
CGContextScaleCTM(destContext, 1.0f, -1.0f);
</code></pre>

<p>虽然我们对超大图片进行了缩放，但是依然较大，特别是在绘制的时候，非常耗性能。所以Sample中的方法是将该图的绘制分成多个Tile来进行，在该Sample中这张图片被分成了14个Tile。sourceTile表示从原图上截取的Tile尺寸，destTile表示最终绘制到界面上的Tile尺寸。</p>
<pre><code>
//源Tile的宽度和原图一直
sourceTile.size.width = sourceResolution.width;
/ * 源Tile的高度等于 **Tile的总像素/Tile的宽度(因为我们从前面了解到，图片的总像素=高度 * 宽度)** Tile用于从原图中截取图片，经过转换变为目标Tile * /
sourceTile.size.height = (int)(tileTotalPixels / sourceTile.size.width);
NSLog(@"source tile size: %f x %f", sourceTile.size.width,
sourceTile.size.height);
sourceTile.origin.x = 0.0f;
//目标Tile的高度和宽度
destTile.size.width = destResolution.width;
destTile.size.height = sourceTile.size.height * imageScale;
destTile.origin.x = 0.0f;
NSLog(@"dest tile size: %f x %f", destTile.size.width, destTile.size.height);
// the source seem overlap is proportionate to the destination seem overlap.
// this is the amount of pixels to overlap each tile as we assemble the ouput
// image.
sourceSeemOverlap = (int)((destSeemOverlap / destResolution.height) *
sourceResolution.height);
NSLog(@"dest seem overlap: %f, source seem overlap: %f", destSeemOverlap,
sourceSeemOverlap);
CGImageRef sourceTileImageRef;
//获取迭代次数，用于表示需要几次读取绘制能将图片展示完毕。
int iterations = (int)(sourceResolution.height / sourceTile.size.height);
//剩余高度
int remainder = (int)sourceResolution.height % (int)sourceTile.size.height;
if (remainder)
iterations++;
// add seem overlaps to the tiles, but save the original tile height for y
// coordinate calculations.
float sourceTileHeightMinusOverlap = sourceTile.size.height;
sourceTile.size.height += sourceSeemOverlap;
destTile.size.height += destSeemOverlap;
NSLog(@"beginning downsize. iterations: %d, tile height: %f, remainder "
@"height: %d",
iterations, sourceTile.size.height, remainder);
//开始读取绘制图片
for (int y = 0; y < iterations; ++y) {
// create an autorelease pool to catch calls to -autorelease made within the
// downsize loop.
NSAutoreleasePool *pool2 = [[NSAutoreleasePool alloc] init];
NSLog(@"iteration %d of %d", y + 1, iterations);
//计算员Tile坐标
sourceTile.origin.y = y * sourceTileHeightMinusOverlap + sourceSeemOverlap;
//目标Tile坐标
destTile.origin.y =
(destResolution.height) -
((y + 1) * sourceTileHeightMinusOverlap * imageScale + destSeemOverlap);
// create a reference to the source image with its context clipped to the
// argument rect.
/ * 获取源图片的一部分，生成sourceTileImageRef，不要忘记一开始我们就将原图保存在了sourceImage.CGImage * /
sourceTileImageRef =
CGImageCreateWithImageInRect(sourceImage.CGImage, sourceTile);

/ * 判断是否是最后一次迭代，并有剩余高度的图片，不能组成一个Tile * /
if (y == iterations - 1 && remainder) {
float dify = destTile.size.height;
destTile.size.height = CGImageGetHeight(sourceTileImageRef) * imageScale;
dify -= destTile.size.height;
destTile.origin.y += dify;
}
//将获取到的源Tile按照目标Tile的尺寸绘制到界面上
CGContextDrawImage(destContext, destTile, sourceTileImageRef);
/* release the source tile portion pixel data. note,
releasing the sourceTileImageRef doesn't actually release the tile portion
pixel
data that we just drew, but the call afterward does. */
CGImageRelease(sourceTileImageRef);
/* while CGImageCreateWithImageInRect lazily loads just the image data
defined by the argument rect,
that data is finally decoded from disk to mem when CGContextDrawImage is
called. sourceTileImageRef
maintains internally a reference to the original image, and that original
image both, houses and
caches that portion of decoded mem. Thus the following call to release the
source image. */
[sourceImage release];
// free all objects that were sent -autorelease within the scope of this
// loop.
[pool2 drain];
// we reallocate the source image after the pool is drained since UIImage
// -imageNamed
// returns us an autoreleased object.
//判断绘制是否结束，如果没有则继续读取原图，进行后续绘制工作。
if (y < iterations - 1) {
sourceImage = [[UIImage alloc]
initWithContentsOfFile:[[NSBundle mainBundle]
pathForResource:kImageFilename
ofType:nil]];
[self performSelectorOnMainThread:@selector(updateScrollView:)
withObject:nil
waitUntilDone:YES];
}
}
NSLog(@"downsize complete.");
//将绘制完毕的图片在ScrollView进行展示
[self performSelectorOnMainThread:@selector(initializeScrollView:)
withObject:nil
waitUntilDone:YES];
// free the context since its job is done. destImageRef retains the pixel data
// now.
CGContextRelease(destContext);
[pool drain];

</code></pre>

<p>该Sample本人看起来还是颇为吃力，只能边看边学。目前大致只能理解到这种程度。我在项目中展示大图的方式更简单暴力，先将图片下载，然后判断未压缩图片占用内存大小。如果超过预设大小，则直接将图片裁剪到预设大小以下再展示。没有采用Sample中的展示方案。//设置你的Cell<br>return cell;<br>}<br><br>在这里推荐用第二种方法，特别是当界面中有多种Cell的情况下，第二种方法在逻辑上更清晰。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UIImage/">UIImage</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-UITableViewCell的重用方法的区别" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/08/16/UITableViewCell的重用方法的区别/" class="article-date">
      <time datetime="2014-08-16T14:43:07.000Z" itemprop="datePublished">2014-08-16</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/16/UITableViewCell的重用方法的区别/">UITableViewCell的重用方法的区别</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><strong>UITableView</strong>想必是iOS开发中最常用的控件。很多Apple自带的APP都使用了它，比如:<em>Phone</em>(该APP为典型得Tab结构,其中<em>Favorites</em>,<em>Recents</em>,<em>Contacts</em>都使用了<strong>UITableView</strong>)、<em>Messages</em>、<em>Mail</em>、<em>Settings</em>等等。</p>
<p><strong>UITableView</strong>最基础的特性莫过于<strong>UITableVIewCell</strong>的重用。讲到这里不得不提我在实习的时候，负责的一个IM功能模块。当时在做聊天窗口的时候，用了ListView来显示聊天信息(这是基于.net平台的一个项目)，当收到聊天消息的时候我做的操作大致如下:</p>
<pre><code>
public void ReceiveMeesage(string text)
{
TextBox txt=new TextBox();
txt.Text=text;
listBox.Items.Add(txt);
}
</code></pre>

<p>或许大家已经看出问题了，随着消息越来越多Item中的控件会越来越多，内存消耗会越来越大，非常影响程序效率。<br>实际上我们并不需要那么多TextBox，假设聊天窗口一次能够展示10条消息，那么实际上我们只需要12个TextBox就能满足展示需要。没错，只需要复用TextBox就行了。在第一个TextBox移除我们视线之后，再将其从后载入，显示新的消息即可。</p>
<p><strong>UITableView</strong>中实现Cell的重用是非常方便的，关键是DataSource中的两个方法，如下:</p>
<p><pre><code><br>-(id)dequeuReusableCellWithIdentifier:(NSString<em> )identifier;<br>-(id)dequeueReusableCellWithIdentifier:(NSString</em> )identifier forIndexPath:(NSIndexPath<em> )indexPath NS_AVAILABLE_IOS(6_0);<br></em></code></pre><br>后者为<strong>iOS6</strong>加入的方法，两个方法的区别为:<br><em>*前者有可能从队列中返回nil，尤其是第一次执行的时候，Queue中没有任何Cell，需要我们手动创建，如下</em>:</p>
<p><pre><code><br>-(UITableViewCell <em> )tableView:(UITableView </em> )tableView cellForRowAtIndexPath:(NSIndexPath <em> )indexPath<br>{<br>static NSString </em> reuseIdentifier=@”cell”;<br>UITableViewCell <em> cell=[tableView dequeueReusableCellWithIdentifier:reuseIdentifier];<br>if(!cell)<br>{<br>//在这里创建UITableViewCell<br>}<br>//设置你的Cell<br>return cell;<br>}<br></em></code></pre><br><em>*后者则不需要我们手动创建Cell，只需要提前注册一个原型Cell即可，假如Queue中没有Cell，程序会用原型Cell帮我们创建好，也就是不会出现返回nil的情况，代码如下:</em></p>
<p><pre><code><br>-(void)viewDidLoad<br>{<br>//初始化UITableView的时候注册原型Cell<br>UITableView <em> tableView=[[UITableView alloc] init];<br>//调用[tableView registerNib:(UINib </em>) forCellReuseIdentifier:(NSString <em>)];<br>//或tableView registerClass:(__unsafe_unretained Class) forCellReuseIdentifier:(NSString </em>)<br>//注册原型Cell<br>self.view=tableView;<br>}</code></pre></p>
<p>-(UITableViewCell <em> )tableView:(UITableView </em> )tableView cellForRowAtIndexPath:(NSIndexPath <em> )indexPath<br>{<br>UITableViewCell </em> cell=[tableView dequeueReusableCellWithIdentifier:reuseIdentifier forIndexPath:(NSIndexPath * )indexPath];<br>//设置你的Cell<br>return cell;<br>}<br><br>在这里推荐用第二种方法，特别是当界面中有多种Cell的情况下，第二种方法在逻辑上更清晰。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UITableVIewCell/">UITableVIewCell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016 YuxiangQ
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、簡潔且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="簡而不減 Hexo 雙欄博客主題  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到訪數"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本頁閱讀量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回頂部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看評論"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="轉到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>